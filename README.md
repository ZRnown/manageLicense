# License Server (è½¯ä»¶æˆæƒç®¡ç†ç³»ç»Ÿ)

åŸºäº FastAPI çš„è½»é‡çº§è½¯ä»¶æˆæƒç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒä¸€æœºä¸€ç éªŒè¯ã€æœ‰æ•ˆæœŸè®¾ç½®ã€Webç®¡ç†åå°ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ“‹ **Webç®¡ç†åå°**: å¯è§†åŒ–ç•Œé¢ç”Ÿæˆå’Œç®¡ç†æˆæƒå¯†é’¥
- ğŸ” **ä¸€æœºä¸€ç **: æ¯ä¸ªå¯†é’¥åªèƒ½ç»‘å®šä¸€å°è®¾å¤‡
- â° **æœ‰æ•ˆæœŸæ§åˆ¶**: æ”¯æŒæ°¸ä¹…æœ‰æ•ˆæˆ–æŒ‡å®šå¤©æ•°
- ğŸ“Š **å®æ—¶ç›‘æ§**: æŸ¥çœ‹å¯†é’¥ä½¿ç”¨çŠ¶æ€å’Œç»‘å®šä¿¡æ¯
- ğŸš€ **PM2ç®¡ç†**: ä½¿ç”¨PM2è¿›è¡Œè¿›ç¨‹å®ˆæŠ¤å’Œè‡ªåŠ¨é‡å¯

## æŠ€æœ¯æ ˆ

- **åç«¯**: FastAPI + Python
- **æ•°æ®åº“**: SQLite
- **è¿›ç¨‹ç®¡ç†**: PM2
- **WebæœåŠ¡**: Uvicorn

## å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒè¦æ±‚

- Python 3.8+
- Node.js (ç”¨äºPM2)
- Git

### 2. å®‰è£…ä¾èµ–

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/your-username/license-server.git
cd license-server

# å®‰è£…Pythonä¾èµ–
pip install -r requirements.txt

# å®‰è£…PM2
npm install -g pm2
```

### 3. é…ç½®

ç¼–è¾‘ `main.py` æ–‡ä»¶ï¼Œä¿®æ”¹ç®¡ç†å‘˜å¯†ç ï¼š

```python
ADMIN_PASSWORD = "your_secret_password"  # ä¿®æ”¹ä¸ºä½ çš„å¯†ç 
```

### 4. å¯åŠ¨æœåŠ¡

**æ–¹å¼ä¸€ï¼šä½¿ç”¨PM2ï¼ˆæ¨èï¼‰**

```bash
# åˆ›å»ºæ—¥å¿—ç›®å½•
mkdir -p logs

# ä½¿ç”¨PM2å¯åŠ¨
pm2 start ecosystem.config.js

# æŸ¥çœ‹çŠ¶æ€
pm2 status

# æŸ¥çœ‹æ—¥å¿—
pm2 logs license-server

# åœæ­¢æœåŠ¡
pm2 stop license-server

# é‡å¯æœåŠ¡
pm2 restart license-server
```

**æ–¹å¼äºŒï¼šç›´æ¥å¯åŠ¨ï¼ˆå¼€å‘ç¯å¢ƒï¼‰**

```bash
uvicorn main:app --host 0.0.0.0 --port 8000
```

### 5. è®¿é—®ç®¡ç†åå°

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š`http://your-server-ip:8000/admin`

è¾“å…¥ç®¡ç†å‘˜å¯†ç å³å¯å¼€å§‹ç”Ÿæˆå’Œç®¡ç†å¯†é’¥ã€‚

## API æ¥å£

### å®¢æˆ·ç«¯æ¿€æ´»

**è¯·æ±‚**

```bash
POST /api/activate
Content-Type: application/json

{
  "key": "YOUR_LICENSE_KEY",
  "hwid": "DEVICE_HARDWARE_ID"
}
```

**å“åº”**

```json
{
  "status": "success",
  "msg": "æ¿€æ´»æˆåŠŸ",
  "days": -1
}
```

## ä½¿ç”¨è¯´æ˜

### ç”Ÿæˆå¯†é’¥

1. è®¿é—®ç®¡ç†åå° `/admin`
2. è¾“å…¥ç®¡ç†å‘˜å¯†ç 
3. è®¾ç½®ç”Ÿæˆæ•°é‡ï¼ˆ1-100ï¼‰
4. é€‰æ‹©æœ‰æ•ˆæœŸï¼š
   - æ°¸ä¹…æœ‰æ•ˆ
   - 30å¤©
   - 1å¹´ï¼ˆ365å¤©ï¼‰
   - 7å¤©è¯•ç”¨
5. æ·»åŠ å¤‡æ³¨ä¿¡æ¯ï¼ˆå¯é€‰ï¼‰
6. ç‚¹å‡»"ç”Ÿæˆå¯†é’¥"æŒ‰é’®

### æ¿€æ´»æµç¨‹

1. å®¢æˆ·ç«¯è·å–è®¾å¤‡å”¯ä¸€æ ‡è¯†ï¼ˆHWIDï¼‰
2. å‘æœåŠ¡å™¨å‘é€æ¿€æ´»è¯·æ±‚ï¼ˆåŒ…å«å¯†é’¥å’ŒHWIDï¼‰
3. æœåŠ¡å™¨éªŒè¯å¯†é’¥ï¼š
   - æ£€æŸ¥å¯†é’¥æ˜¯å¦å­˜åœ¨
   - æ£€æŸ¥æ˜¯å¦å·²ç»‘å®šå…¶ä»–è®¾å¤‡
   - å¦‚æœæœªä½¿ç”¨ï¼Œåˆ™ç»‘å®šå½“å‰è®¾å¤‡
4. è¿”å›æ¿€æ´»ç»“æœ

## é¡¹ç›®ç»“æ„

```
license-server/
â”œâ”€â”€ main.py                 # ä¸»ç¨‹åºæ–‡ä»¶
â”œâ”€â”€ requirements.txt        # Pythonä¾èµ–
â”œâ”€â”€ ecosystem.config.js     # PM2é…ç½®
â”œâ”€â”€ .gitignore             # Gitå¿½ç•¥æ–‡ä»¶
â””â”€â”€ README.md              # è¯´æ˜æ–‡æ¡£
```

## PM2 å¸¸ç”¨å‘½ä»¤

```bash
# å¯åŠ¨åº”ç”¨
pm2 start ecosystem.config.js

# åœæ­¢åº”ç”¨
pm2 stop license-server

# é‡å¯åº”ç”¨
pm2 restart license-server

# åˆ é™¤åº”ç”¨
pm2 delete license-server

# æŸ¥çœ‹åº”ç”¨ä¿¡æ¯
pm2 show license-server

# æŸ¥çœ‹æ—¥å¿—
pm2 logs license-server

# ç›‘æ§
pm2 monit

# å¼€æœºè‡ªå¯
pm2 startup
pm2 save
```

## å®‰å…¨å»ºè®®

1. **ä¿®æ”¹ç®¡ç†å‘˜å¯†ç **: éƒ¨ç½²å‰åŠ¡å¿…ä¿®æ”¹é»˜è®¤å¯†ç 
2. **ä½¿ç”¨HTTPS**: ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨åå‘ä»£ç†ï¼ˆå¦‚Nginxï¼‰é…ç½®SSL
3. **é˜²ç«å¢™è®¾ç½®**: ä»…å¼€æ”¾å¿…è¦ç«¯å£
4. **å®šæœŸå¤‡ä»½**: å®šæœŸå¤‡ä»½SQLiteæ•°æ®åº“æ–‡ä»¶

## æ³¨æ„äº‹é¡¹

- SQLiteæ•°æ®åº“æ–‡ä»¶ (`licenses.db`) ä¸ä¼šä¸Šä¼ åˆ°Git
- æ—¥å¿—æ–‡ä»¶å­˜å‚¨åœ¨ `logs/` ç›®å½•
- PM2é…ç½®æ–‡ä»¶å·²è®¾ç½®å†…å­˜é™åˆ¶ï¼ˆ1Gï¼‰å’Œè‡ªåŠ¨é‡å¯

## è®¸å¯è¯

MIT License

## ä½œè€…

Your Name
# manageLicense
